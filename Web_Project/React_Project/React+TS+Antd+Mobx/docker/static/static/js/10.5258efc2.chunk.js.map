{"version":3,"sources":["api/config.ts","Pages/Login/index.tsx"],"names":["config","data","request","url","method","check","layout","labelCol","span","wrapperCol","tailLayout","offset","Index","inject","props","context","handleResize","height","window","document","body","clientHeight","width","clientWidth","setState","then","response","code","history","push","onFinish","values","login","msg","message","error","Promise","reject","token","set","admin","permission","initPermission","location","href","onFinishFailed","errorInfo","console","log","state","name","password","addEventListener","bind","className","style","this","id","ref","initialValues","Item","label","rules","required","type","min","Password","htmlType","Component","withRouter"],"mappings":"6HAAA,gFAEaA,EAAS,SAACC,GACnB,OAAOC,YAAQ,CACXC,IAAK,gBACLC,OAAQ,OACRH,KAAMA,KAGDI,EAAQ,WACjB,OAAOH,YAAQ,CACXC,IAAK,0B,0NCAPG,EAAS,CACXC,SAAU,CAACC,KAAM,GACjBC,WAAY,CAACD,KAAM,KAEjBE,EAAa,CACfD,WAAY,CAACE,OAAQ,EAAGH,KAAM,KAkB5BI,EAFLC,YAAO,Q,GACPA,YAAO,a,qDAEJ,WAAYC,EAAeC,GAAe,IAAD,uBACrC,cAAMD,EAAOC,IAajBC,aAAe,WACX,IAAIC,EAASC,OAAOC,SAASC,KAAKC,aAC9BC,EAAQJ,OAAOC,SAASC,KAAKG,YACjC,EAAKC,SAAS,CACVF,MAAOA,EACPL,OAAQA,KAnByB,EAsBzCZ,MAAQ,WACJA,cAAQoB,MAAK,SAAAC,GAEI,IADEA,EAASzB,KAAjB0B,MAEH,EAAKb,MAAMc,QAAQC,KAAK,eA1BK,EA8BzCC,SAAW,SAACC,GACRC,YAAMD,GAAQN,MAAK,SAACC,GAAc,IAAD,EACTA,EAASzB,KAAtB0B,EADsB,EACtBA,KAAMM,EADgB,EAChBA,IACb,GAAa,IAATN,EAUA,OADAO,IAAQC,MAAMF,GACPG,QAAQC,OAAOJ,GAVT,IAAD,IACLK,EAASZ,EAASzB,KAAKA,KAAvBqC,MACPC,YAAI,QAASD,GACb,YAAKxB,MAAM0B,aAAX,SAAkBR,MAAMD,GACxB,YAAKjB,MAAM2B,kBAAX,SAAuBC,iBACvBxB,OAAOyB,SAASC,KAAO,QAtCM,EA+CzCC,eAAiB,SAACC,GACdC,QAAQC,IAAI,UAAWF,IA9CvB,IAAI7B,EAASC,OAAOC,SAASC,KAAKC,aAC9BC,EAAQJ,OAAOC,SAASC,KAAKG,YAHI,OAIrC,EAAK0B,MAAQ,CACT3B,MAAOA,EACPL,OAAQA,EACRiC,KAAM,GACNC,SAAU,IAEd,EAAK9C,QACLa,OAAOkC,iBAAiB,SAAU,EAAKpC,aAAaqC,KAAlB,iBAXG,E,0CAmDzC,WACI,OACI,qBACIC,UAAU,QACVC,MAAO,CACHjC,MAAOkC,KAAKP,MAAM3B,MAAQ,KAC1BL,OAAQuC,KAAKP,MAAMhC,OAAS,MAJpC,SAOI,eAAC,IAAD,yBACIwC,GAAG,aACHH,UAAU,aACVI,IAAK,KACLC,cAAeH,KAAKP,MACpBnB,SAAU0B,KAAK1B,SACfe,eAAgBW,KAAKX,gBACjBvC,GAPR,cASI,cAAC,IAAKsD,KAAN,CACIC,MAAM,qBACNX,KAAK,OACLY,MAAO,CACH,CACIC,UAAU,EACV7B,QAAS,oDAEb,CACI8B,KAAM,SACNC,IAAK,EACL/B,QAAS,wEAXrB,SAeI,cAAC,IAAD,MAEJ,cAAC,IAAK0B,KAAN,CACIC,MAAM,eACNX,KAAK,WACLY,MAAO,CACH,CACIC,UAAU,EACV7B,QAAS,8CAEb,CACI8B,KAAM,SACNC,IAAK,EACL/B,QAAS,kEAXrB,SAeI,cAAC,IAAMgC,SAAP,MAGJ,cAAC,IAAKN,KAAN,2BAAelD,GAAf,aACI,cAAC,IAAD,CAAQsD,KAAK,UAAUG,SAAS,SAAhC,uC,GA1GJC,e,MAqHLC,sBAAWzD","file":"static/js/10.5258efc2.chunk.js","sourcesContent":["import request from '../utils/request'\n\nexport const config = (data: any) => {\n    return request({\n        url: '/admin/config',\n        method: 'post',\n        data: data\n    })\n}\nexport const check = () => {\n    return request({\n        url: '/admin/config/check'\n    })\n}\n","import React, {Component} from \"react\";\nimport {RouteComponentProps, withRouter} from \"react-router-dom\";\nimport {Button, Form, Input, message} from 'antd'\nimport '../../static/css/login/login.css'\nimport {inject} from \"mobx-react\";\nimport Admin from \"../../store/Admin\";\nimport {login} from \"../../api/login\";\nimport Permission from \"../../store/Permission\";\nimport {set} from \"../../utils/storage\";\nimport {check} from \"../../api/config\";\n\nconst layout = {\n    labelCol: {span: 4},\n    wrapperCol: {span: 16},\n};\nconst tailLayout = {\n    wrapperCol: {offset: 8, span: 16},\n};\n\ninterface IState {\n    name: string\n    password: string\n\n    width: number\n    height: number\n}\n\ninterface IProps extends RouteComponentProps {\n    admin?: Admin\n    permission?: Permission\n}\n\n@inject('admin')\n@inject('permission')\nclass Index extends Component<IProps, IState> {\n    constructor(props: IProps, context: any) {\n        super(props, context);\n        let height = window.document.body.clientHeight\n        let width = window.document.body.clientWidth\n        this.state = {\n            width: width,\n            height: height,\n            name: '',\n            password: ''\n        }\n        this.check()\n        window.addEventListener('resize', this.handleResize.bind(this)) //监听窗口大小改变\n    }\n\n    handleResize = () => {\n        let height = window.document.body.clientHeight\n        let width = window.document.body.clientWidth\n        this.setState({\n            width: width,\n            height: height\n        })\n    }\n    check = () => {\n        check().then(response => {\n            const {code} = response.data\n            if (code === 1) {\n                this.props.history.push('/config')\n            }\n        })\n    }\n    onFinish = (values: IState) => {\n        login(values).then((response) => {\n            const {code, msg} = response.data\n            if (code === 0) {\n                const {token} = response.data.data;\n                set('token', token)\n                this.props.admin?.login(values)\n                this.props.permission?.initPermission();\n                window.location.href = '/'\n                // 因为localstorage存储之后立马取值 会有延迟 ，用  window.location.href 不会\n                // this.props.history.push('/')\n            } else {\n                message.error(msg)\n                return Promise.reject(msg)\n            }\n        })\n    }\n    onFinishFailed = (errorInfo: any) => {\n        console.log('Failed:', errorInfo);\n    };\n\n    render() {\n        return (\n            <div\n                className='login'\n                style={{\n                    width: this.state.width + 'px',\n                    height: this.state.height + 'px'\n                }}\n            >\n                <Form\n                    id='login-form'\n                    className='login-form'\n                    ref={null}\n                    initialValues={this.state}\n                    onFinish={this.onFinish}\n                    onFinishFailed={this.onFinishFailed}\n                    {...layout}\n                >\n                    <Form.Item\n                        label=\"用户名\"\n                        name=\"name\"\n                        rules={[\n                            {\n                                required: true,\n                                message: '用户名不可以为空'\n                            },\n                            {\n                                type: \"string\",\n                                min: 2,\n                                message: '用户名长度不可以小于2位'\n                            }\n                        ]}\n                    >\n                        <Input/>\n                    </Form.Item>\n                    <Form.Item\n                        label=\"密码\"\n                        name=\"password\"\n                        rules={[\n                            {\n                                required: true,\n                                message: '密码不可以为空'\n                            },\n                            {\n                                type: \"string\",\n                                min: 2,\n                                message: '密码长度不可以小于2位'\n                            }\n                        ]}\n                    >\n                        <Input.Password/>\n                    </Form.Item>\n\n                    <Form.Item {...tailLayout}>\n                        <Button type=\"primary\" htmlType=\"submit\">\n                            登录\n                        </Button>\n                    </Form.Item>\n                </Form>\n            </div>\n        )\n    }\n\n}\n\nexport default withRouter(Index)\n"],"sourceRoot":""}